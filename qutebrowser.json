{
    "id": "org.qutebrowser.desktop",
    "branch": "master",
    "runtime": "org.kde.Platform",
    "runtime-version": "master",
    "sdk": "org.kde.Sdk",
    "command": "qutebrowser",
    "tags": ["nightly"],
    "rename-desktop-file": "qutebrowser.desktop",
    "desktop-file-name-prefix": "(Nightly)",
    "finish-args": [
        "--share=ipc", "--share=network", "--socket=x11", "--socket=wayland",
        "--filesystem=host", "--env=QT_QPA_PLATFORM=flatpak",
        "--env=PYTHONPATH=/app/usr/lib/python3.5/site-packages/" 
    ],
    "modules": [
        {
            "name": "jinja",
            "config-opts": [ "--disable-static", "--enable-x11" ],
            "no-autogen": true,
            "buildsystem": "simple",
            "build-commands": [ "PYTHONPATH=/app/usr/lib/python3.5/site-packages/ pip3 install --no-dependencies --root /app ." ],
            "sources": [
                 {
                     "type": "archive",
                     "url": "https://pypi.python.org/packages/90/61/f820ff0076a2599dd39406dcb858ecb239438c02ce706c8e91131ab9c7f1/Jinja2-2.9.6.tar.gz",
                     "sha256": "ddaa01a212cd6d641401cb01b605f4a4d9f37bfc93043d7f760ec70fb99ff9ff"
                 }
            ],
            "modules": [
                {
                    "name": "pytest",
                    "no-autogen": true,
                    "buildsystem": "simple",
                    "build-commands": [ "PYTHONPATH=/app/usr/lib/python3.5/site-packages/ pip3 install --no-dependencies --root /app ." ],
                    "cleanup": ["*"],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://pypi.python.org/packages/72/2b/2d3155e01f45a5a04427857352ee88220ee39550b2bc078f9db3190aea46/pytest-3.1.2.tar.gz",
                            "sha256": "795ec29fbba70b22a593691ce8bcd4bdde2dc96e8099731f73c7d8bb3ce879bf"
                        }
                    ],
                    "modules": [
                        {
                            "name": "setuptools-scm",
                            "no-autogen": true,
                            "buildsystem": "simple",
                            "cleanup": ["*"],
                            "build-commands": [ "PYTHONPATH=/app/usr/lib/python3.5/site-packages/ pip3 install --no-dependencies --root /app ." ],
                            "sources": [
                                {
                                    "type": "archive",
                                    "url": "https://pypi.python.org/packages/03/6d/aafdd01edd227ee879b691455bf19895091872af7e48192bea1758c82032/setuptools_scm-1.15.6.tar.gz",
                                    "sha256": "49ab4685589986a42da85706b3311a2f74f1af567d39fee6cb1e088d7a75fb5f"
                                }
                            ]
                        }
                    ]
                }
            ]
        },
        {
            "name": "markupsafe",
            "config-opts": [ "--disable-static", "--enable-x11" ],
            "no-autogen": true,
            "buildsystem": "simple",
            "build-commands": [ "PYTHONPATH=/app/usr/lib/python3.5/site-packages/ pip3 install --no-dependencies --root /app ." ],
            "sources": [
                 {
                     "type": "archive",
                     "url": "https://pypi.python.org/packages/4d/de/32d741db316d8fdb7680822dd37001ef7a448255de9699ab4bfcbdf4172b/MarkupSafe-1.0.tar.gz",
                     "sha256": "a6be69091dac236ea9c6bc7d012beab42010fa914c459791d627dad4910eb665"
                 }
            ]
        },
        {
            "name": "yaml",
            "config-opts": [ "--disable-static", "--enable-x11" ],
            "no-autogen": true,
            "buildsystem": "simple",
            "build-commands": [ "PYTHONPATH=/app/usr/lib/python3.5/site-packages/ pip3 install --no-dependencies --root /app ." ],
            "sources": [
                 {
                     "type": "archive",
                     "url": "http://pyyaml.org/download/pyyaml/PyYAML-3.12.tar.gz",
                     "sha256": "592766c6303207a20efc445587778322d7f73b161bd994f227adaa341ba212ab"
                 }
            ]
        },
        {
            "name": "pygments",
            "config-opts": [ "--disable-static", "--enable-x11" ],
            "no-autogen": true,
            "buildsystem": "simple",
            "build-commands": [ "PYTHONPATH=/app/usr/lib/python3.5/site-packages/ pip3 install --no-dependencies --root /app ." ],
            "sources": [
                 {
                     "type": "archive",
                     "url": "https://pypi.python.org/packages/71/2a/2e4e77803a8bd6408a2903340ac498cb0a2181811af7c9ec92cb70b0308a/Pygments-2.2.0.tar.gz",
                     "sha256": "dbae1046def0efb574852fab9e90209b23f556367b5a320c0bcb871c77c3e8cc"
                 }
            ]
        },
        {
            "name": "colorama",
            "config-opts": [ "--disable-static", "--enable-x11" ],
            "no-autogen": true,
            "buildsystem": "simple",
            "build-commands": [ "PYTHONPATH=/app/usr/lib/python3.5/site-packages/ pip3 install --no-dependencies --root /app ." ],
            "sources": [
                 {
                     "type": "archive",
                     "url": "https://pypi.python.org/packages/e6/76/257b53926889e2835355d74fec73d82662100135293e17d382e2b74d1669/colorama-0.3.9.tar.gz",
                     "sha256": "48eb22f4f8461b1df5734a074b57042430fb06e1d61bd1e11b078c0fe6d7a1f1"
                 }
            ]
        },
        {
            "name": "pyopengl",
            "config-opts": [ "--disable-static", "--enable-x11" ],
            "no-autogen": true,
            "buildsystem": "simple",
            "build-commands": [ "PYTHONPATH=/app/usr/lib/python3.5/site-packages/ pip3 install --no-dependencies --root /app ." ],
            "sources": [
                 {
                     "type": "archive",
                     "url": "https://pypi.python.org/packages/f0/d6/daabe9beb313c0f40225e179f92d5faf8f0557213d75ff52b9b759f5d1c9/PyOpenGL-3.1.1a1.zip",
                     "sha256": "fc9b6b95776f4cd1da9e4e9fe45a85c995fc8490154cbac1031ed54e0465dc92"
                 }
            ]
        },
        {
            "name": "peg2",
            "config-opts": [ "--disable-static", "--enable-x11" ],
            "no-autogen": true,
            "buildsystem": "simple",
            "build-commands": [ "PYTHONPATH=/app/usr/lib/python3.5/site-packages/ pip3 install --no-dependencies --root /app ." ],
            "sources": [
                 {
                     "type": "archive",
                     "url": "https://pypi.python.org/packages/f9/bd/10398e2c2d2070cc8a9c7153abfbd4ddb2895a2c52a32722ab8689e0cc7d/pyPEG2-2.15.2.tar.gz",
                     "sha256": "2b2d4f80d8e1a9370b2a91f4a25f4abf7f69b85c8da84cd23ec36451958a1f6d"
                 }
            ]
        },
        {
            "name": "cssutils",
            "config-opts": [ "--disable-static", "--enable-x11" ],
            "no-autogen": true,
            "buildsystem": "simple",
            "build-commands": [ "PYTHONPATH=/app/usr/lib/python3.5/site-packages/ pip3 install --no-dependencies --root /app ." ],
            "sources": [
                 {
                     "type": "archive",
                     "url": "https://pypi.python.org/packages/5c/0b/c5f29d29c037e97043770b5e7c740b6252993e4b57f029b3cd03c78ddfec/cssutils-1.0.2.tar.gz",
                     "sha256": "a2fcf06467553038e98fea9cfe36af2bf14063eb147a70958cfcaa8f5786acaf"
                 }
            ]
        },
        {
            "name": "pyqt5",
            "config-opts": [ "--disable-static", "--enable-x11" ],
            "no-autogen": true,
            "buildsystem": "simple",
            "build-commands": [ 
                "PATH=$PATH:/usr/bin/ PYTHONPATH=/usr/lib/python3.5/site-packages/ python3 configure.py -d /usr/lib/python3.5/site-packages/ --assume-shared --confirm-license --sysroot=/app -w --sip=/app/usr/bin/sip --sip-incdir=/app/usr/include/python3.5m/ -verbose QMAKE_CFLAGS_RELEASE='-I/usr/include/python3.5m/' QMAKE_CXXFLAGS_RELEASE='-I/usr/include/python3.5m/'", 
                "make", "make install DESTDIR=/app INSTALL_ROOT=/app"
            ],
            "sources": [
                 {
                     "type": "archive",
                     "url": "https://sourceforge.net/projects/pyqt/files/PyQt5/PyQt-5.8.2/PyQt5_gpl-5.8.2.tar.gz",
                     "sha256": "ebd70515b30bbd6098fee29e6271a6696b1183c5530ee30e6ba9aaab195536e8"
                 }
            ],
            "modules": [
                {
                    "name": "sip",
                    "no-autogen": true,
                    "buildsystem": "simple",
                    "build-options": {
                        "cflags" : "-I/usr/include/python3.5m/"
                    },
                    "build-commands": [ 
                        "PYTHONPATH=/app/usr/lib/python3.5/site-packages/ python3 configure.py -b /usr/bin/ -d /usr/lib/python3.5/site-packages/", 
                        "make", "make install DESTDIR=/app"
                    ],
                    "sources": [
                        {
                            "type": "archive",
                            "url": "https://sourceforge.net/projects/pyqt/files/sip/sip-4.19.2/sip-4.19.2.tar.gz",
                            "sha256": "432b4aad25254e6997913e33b1ca3cf5fd21d5729a50a3ce2edccbea82c80533"
                        }
                    ]
                }
            ]
        },
        {
            "name": "setuptools",
            "config-opts": [ "--disable-static", "--enable-x11" ],
            "no-autogen": true,
            "buildsystem": "simple",
            "build-commands": [ "PYTHONPATH=/app/usr/lib/python3.5/site-packages/ pip3 install --no-dependencies --ignore-installed --root /app ." ],
            "sources": [
                 {
                     "type": "archive",
                     "url": "https://pypi.python.org/packages/a9/23/720c7558ba6ad3e0f5ad01e0d6ea2288b486da32f053c73e259f7c392042/setuptools-36.0.1.zip",
                     "sha256": "e17c4687fddd6d70a6604ac0ad25e33324cec71b5137267dd5c45e103c4b288a"
                 }
            ]
        },
        {
            "name": "qutebrowser",
            "buildsystem": "simple",
            "build-options": {
                "no-debuginfo": false
            },
            "comment": "COMMENT: Cant get the icon to install properly.",
            "build-commands": [
                "python3 setup.py install --root=/app",
                "install -v -D qutebrowser.desktop -t /app/share/applications/",
                "mv /app/usr/bin* /app/bin -v"
            ],
            "sources": [ {"type": "git", "url": "https://github.com/qutebrowser/qutebrowser.git" } ]
        }
    ]
}


